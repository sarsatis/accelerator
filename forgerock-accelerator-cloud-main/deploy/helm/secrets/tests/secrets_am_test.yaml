suite: access-manager Secrets tests
templates:
  - ../templates/secrets-am.yaml
tests:
  - it: Check deploy.yaml values
    values:
      - ../values.yaml

    asserts:
      - isKind:
          of: Secret
      - isAPIVersion:
          of: v1
      - exists:
          path: stringData.AM_ENCRYPTION_KEY
      - isNotNullOrEmpty:
          path: stringData.AM_ENCRYPTION_KEY
      - exists:
          path: stringData.SECRET_ENCKEY_DIRECT
      - isNotNullOrEmpty:
          path: stringData.SECRET_ENCKEY_DIRECT
      - exists:
          path: stringData.SECRET_ENCKEY_HMACSIGN
      - isNotNullOrEmpty:
          path: stringData.SECRET_ENCKEY_HMACSIGN
      - exists:
          path: stringData.SECRET_ENCKEY_SELFSERVICESIGN
      - isNotNullOrEmpty:
          path: stringData.SECRET_ENCKEY_SELFSERVICESIGN
      - exists:
          path: stringData.AM_AUTHENTICATION_SHARED_SECRET
      - isNotNullOrEmpty:
          path: stringData.AM_AUTHENTICATION_SHARED_SECRET
      - exists:
          path: stringData.AM_SESSION_STATELESS_SIGNING_KEY
      - isNotNullOrEmpty:
          path: stringData.AM_SESSION_STATELESS_SIGNING_KEY
      - exists:
          path: stringData.AM_SESSION_STATELESS_ENCRYPTION_KEY
      - isNotNullOrEmpty:
          path: stringData.AM_SESSION_STATELESS_ENCRYPTION_KEY
      - exists:
          path: stringData.AM_OIDC_CLIENT_SUBJECT_IDENTIFIER_HASH_SALT
      - isNotNullOrEmpty:
          path: stringData.AM_OIDC_CLIENT_SUBJECT_IDENTIFIER_HASH_SALT
      - exists:
          path: stringData.AM_SELFSERVICE_LEGACY_CONFIRMATION_EMAIL_LINK_SIGNING_KEY
      - isNotNullOrEmpty:
          path: stringData.AM_SELFSERVICE_LEGACY_CONFIRMATION_EMAIL_LINK_SIGNING_KEY
      - exists:
          path: stringData.AM_KEYSTORE_DEFAULT_ENTRY_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_KEYSTORE_DEFAULT_ENTRY_PASSWORD
      - exists:
          path: stringData.AM_KEYSTORE_DEFAULT_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_KEYSTORE_DEFAULT_PASSWORD
      - exists:
          path: stringData.AM_PASSWORDS_AMADMIN_CLEAR
      - isNotNullOrEmpty:
          path: stringData.AM_PASSWORDS_AMADMIN_CLEAR
      - exists:
          path: stringData.AM_PASSWORDS_TRUSTSTORE
      - isNotNullOrEmpty:
          path: stringData.AM_PASSWORDS_TRUSTSTORE
      - exists:
          path: stringData.AM_PROMETHEUS_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_PROMETHEUS_PASSWORD
      - exists:
          path: stringData.AM_STORES_APPLICATION_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_STORES_APPLICATION_PASSWORD
      - exists:
          path: stringData.AM_STORES_CTS_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_STORES_CTS_PASSWORD
      - exists:
          path: stringData.AM_STORES_POLICY_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_STORES_POLICY_PASSWORD
      - exists:
          path: stringData.AM_STORES_UMA_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_STORES_UMA_PASSWORD
      - exists:
          path: stringData.AM_STORES_USER_PASSWORD
      - isNotNullOrEmpty:
          path: stringData.AM_STORES_USER_PASSWORD
      - exists:
          path: stringData.SECRET_CERTIFICATE_RSAJWTSIGN
      - isNotNullOrEmpty:
          path: stringData.SECRET_CERTIFICATE_RSAJWTSIGN
      - exists:
          path: stringData.SECRET_CERTIFICATE_RSAJWTSIGN_KEY
      - isNotNullOrEmpty:
          path: stringData.SECRET_CERTIFICATE_RSAJWTSIGN_KEY
      - exists:
          path: stringData.SECRET_CERTIFICATE_SELFSERVICEENC
      - isNotNullOrEmpty:
          path: stringData.SECRET_CERTIFICATE_SELFSERVICEENC
      - exists:
          path: stringData.SECRET_CERTIFICATE_SELFSERVICEENC_KEY
      - isNotNullOrEmpty:
          path: stringData.SECRET_CERTIFICATE_SELFSERVICEENC_KEY
      - exists:
          path: stringData.SECRET_CERTIFICATE
      - isNotNullOrEmpty:
          path: stringData.SECRET_CERTIFICATE
      - exists:
          path: stringData.SECRET_CERTIFICATE_KEY
      - isNotNullOrEmpty:
          path: stringData.SECRET_CERTIFICATE_KEY
    